autointent.modules.retrieval
============================

.. py:module:: autointent.modules.retrieval


Classes
-------

.. autoapisummary::

   autointent.modules.retrieval.RetrievalModule
   autointent.modules.retrieval.VectorDBModule


Package Contents
----------------

.. py:class:: RetrievalModule(k)

   Bases: :py:obj:`autointent.modules.Module`, :py:obj:`abc.ABC`


   Base class for retrieval modules.


   .. py:attribute:: k


.. py:class:: VectorDBModule(k, embedder_name, db_dir = None, device = 'cpu', batch_size = 32, max_length = None)

   Bases: :py:obj:`autointent.modules.retrieval._base.RetrievalModule`


   Module for managing retrieval operations using a vector database.

   This class provides methods for indexing, querying, and managing a vector database for tasks
   such as nearest neighbor retrieval.


   .. py:attribute:: vector_index
      :type:  autointent.context.vector_index_client.VectorIndex


   .. py:attribute:: name
      :value: 'vector_db'



   .. py:attribute:: embedder_name


   .. py:attribute:: device


   .. py:attribute:: batch_size


   .. py:attribute:: max_length


   .. py:method:: from_context(context, k, embedder_name)
      :classmethod:


      Create a VectorDBModule instance using a Context object.

      :param context: The context containing configurations and utilities.
      :param k: Number of nearest neighbors to retrieve.
      :param embedder_name: Name of the embedder to use.
      :return: Initialized VectorDBModule instance.



   .. py:property:: db_dir
      :type: str


      Get the directory for the vector database.

      :return: Path to the database directory.



   .. py:method:: fit(utterances, labels)

      Fit the vector index using the provided utterances and labels.

      :param utterances: List of text data to index.
      :param labels: List of corresponding labels for the utterances.



   .. py:method:: score(context, metric_fn)

      Evaluate the retrieval model using a specified metric function.

      :param context: The context containing test data and labels.
      :param metric_fn: Function to compute the retrieval metric.
      :return: Computed metric score.



   .. py:method:: get_assets()

      Get the retriever artifacts for this module.

      :return: A RetrieverArtifact object containing embedder information.



   .. py:method:: clear_cache()

      Clear cached data in memory used by the vector index.



   .. py:method:: dump(path)

      Save the module's metadata and vector index to a specified directory.

      :param path: Path to the directory where assets will be dumped.



   .. py:method:: load(path)

      Load the module's metadata and vector index from a specified directory.

      :param path: Path to the directory containing the dumped assets.



   .. py:method:: predict(utterances)

      Predict the nearest neighbors for a list of utterances.

      :param utterances: List of utterances for which nearest neighbors are to be retrieved.
      :return: A tuple containing:
          - labels: List of retrieved labels for each utterance.
          - distances: List of distances to the nearest neighbors.
          - texts: List of retrieved text data corresponding to the neighbors.



